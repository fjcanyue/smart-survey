# ğŸš€ æ™ºèƒ½é—®å·ç³»ç»Ÿ (Smart Survey)

åŸºäº SurveyJS ä¸å¤§è¯­è¨€æ¨¡å‹çš„è½»é‡çº§åœ¨çº¿é—®å·è°ƒæŸ¥ç³»ç»Ÿï¼Œæ”¯æŒè‡ªç„¶è¯­è¨€ç”Ÿæˆé—®å·ï¼Œé›¶æˆæœ¬éƒ¨ç½²åœ¨ Cloudflare ç”Ÿæ€ç³»ç»Ÿä¸Šã€‚

## âœ¨ ç‰¹æ€§

- ğŸ¤– **AI é—®å·ç”Ÿæˆ**ï¼šé€šè¿‡è‡ªç„¶è¯­è¨€æè¿°è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šé—®å·
- ğŸ“ **å¤šç§é¢˜å‹æ”¯æŒ**ï¼šå•é€‰ã€å¤šé€‰ã€æ–‡æœ¬è¾“å…¥ã€è¯„åˆ†ã€æ’åºç­‰
- ğŸ’° **é›¶æˆæœ¬éƒ¨ç½²**ï¼šåŸºäº Cloudflare Pages + Workers + D1 å…è´¹å¥—é¤
- ğŸ”„ **å¤š LLM æ”¯æŒ**ï¼šOpenAI GPTã€Google Geminiã€Anthropic Claude
- ğŸ“Š **å®æ—¶æ•°æ®åˆ†æ**ï¼šé—®å·ç»“æœå¯è§†åŒ–å±•ç¤º
- ğŸ¨ **ç¾è§‚ç•Œé¢**ï¼šåŸºäº SurveyJS çš„ç°ä»£åŒ– UI
- âš¡ **è¾¹ç¼˜è®¡ç®—**ï¼šå…¨çƒ CDN åŠ é€Ÿï¼Œä½å»¶è¿Ÿå“åº”
- ğŸ”’ **å®‰å…¨å¯é **ï¼šAPI å¯†é’¥å®‰å…¨ç®¡ç†ï¼Œè¾“å…¥éªŒè¯

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·æµè§ˆå™¨    â”‚    â”‚ Cloudflare Pages â”‚    â”‚ External APIs   â”‚
â”‚                 â”‚    â”‚   (å‰ç«¯é™æ€)     â”‚    â”‚                 â”‚
â”‚  React SPA      â”‚â—„â”€â”€â–ºâ”‚                  â”‚    â”‚   OpenAI GPT    â”‚
â”‚  - é—®å·åˆ›å»ºå™¨   â”‚    â”‚                  â”‚    â”‚   Google Gemini â”‚
â”‚  - é—®å·è¿è¡Œå™¨   â”‚    â”‚                  â”‚    â”‚   Claude API    â”‚
â”‚  - ç»“æœæŸ¥çœ‹å™¨   â”‚    â”‚                  â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â–²
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
â”‚               Cloudflare Worker (åç«¯ API)                   â”‚
â”‚  - è·¯ç”±å¤„ç†    - LLM é›†æˆ    - æ•°æ®åº“æ“ä½œ    - ä¸šåŠ¡é€»è¾‘      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Cloudflare D1     â”‚
                    â”‚    (SQL æ•°æ®åº“)     â”‚
                    â”‚  - surveys è¡¨       â”‚
                    â”‚  - results è¡¨       â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®æ¡ä»¶

- Node.js 18+
- Cloudflare è´¦æˆ·
- è‡³å°‘ä¸€ä¸ª LLM API Key (OpenAI/Gemini/Claude)

### 1. å…‹éš†é¡¹ç›®

```bash
git clone <your-repo-url>
cd smart-survey
```

### 2. éƒ¨ç½²åç«¯

```bash
cd backend

# å®‰è£…ä¾èµ–
npm install

# ç™»å½• Cloudflare
npx wrangler auth login

# åˆ›å»ºæ•°æ®åº“
npx wrangler d1 create smart-survey-db

# æ›´æ–° wrangler.toml ä¸­çš„ database_id

# è®¾ç½® API å¯†é’¥ï¼ˆé€‰æ‹©ä¸€ä¸ªï¼‰
npx wrangler secret put OPENAI_API_KEY     # OpenAI
npx wrangler secret put GEMINI_API_KEY     # Google Gemini
npx wrangler secret put CLAUDE_API_KEY     # Anthropic Claude

# éƒ¨ç½² Worker
npx wrangler deploy
```

### 3. éƒ¨ç½²å‰ç«¯

```bash
cd frontend

# å®‰è£…ä¾èµ–
npm install

# æ›´æ–° API åŸºç¡€ URL é…ç½®
# ç¼–è¾‘ src/config.jsï¼Œè®¾ç½®åç«¯ Worker URL

# æ„å»ºå‰ç«¯
npm run build

# éƒ¨ç½²åˆ° Cloudflare Pages (æˆ–æ‰‹åŠ¨ä¸Šä¼  build ç›®å½•)
```

### 4. éªŒè¯éƒ¨ç½²

è®¿é—®ä½ çš„ Worker URL + `/api/test`ï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```json
{"message": "API is working"}
```

## ğŸ“š API æ–‡æ¡£

### ğŸ¤– ç”Ÿæˆé—®å·
```http
POST /api/surveys/generate
Content-Type: application/json

{
  "prompt": "åˆ›å»ºä¸€ä¸ªå…³äºå‘˜å·¥å¯¹å…¬å¸é£Ÿå ‚æ»¡æ„åº¦çš„è°ƒæŸ¥é—®å·"
}
```

**å“åº”ï¼š**
```json
{
  "id": "survey_1234567890_abc123",
  "json": {
    "title": "å‘˜å·¥é£Ÿå ‚æ»¡æ„åº¦è°ƒæŸ¥",
    "pages": [...]
  }
}
```

### ğŸ’¾ ä¿å­˜é—®å·
```http
POST /api/surveys
Content-Type: application/json

{
  "id": "survey_1234567890_abc123",
  "json": { /* SurveyJS JSON */ }
}
```

### ğŸ“– è·å–é—®å·
```http
GET /api/surveys/{survey_id}
```

### ğŸ“ æäº¤ç­”æ¡ˆ
```http
POST /api/results/{survey_id}
Content-Type: application/json

{
  "data": {
    "question1": "answer1",
    "question2": ["option1", "option2"]
  }
}
```

### ğŸ“Š è·å–ç»“æœ
```http
GET /api/results/{survey_id}?limit=100&offset=0
```

## ğŸ—‚ï¸ é¡¹ç›®ç»“æ„

```
smart-survey/
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ DESIGN.md                   # è¯¦ç»†è®¾è®¡æ–‡æ¡£
â”œâ”€â”€ ITERATION_PLAN.md           # è¿­ä»£å¼€å‘è®¡åˆ’
â”œâ”€â”€ CLAUDE.md                   # Claude Code æŒ‡å¯¼æ–‡æ¡£
â”œâ”€â”€ backend/                    # åç«¯ Cloudflare Worker
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ worker.js          # Worker å…¥å£æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”‚   â”œâ”€â”€ llm.js         # LLM API é›†æˆ
â”‚   â”‚   â”‚   â””â”€â”€ database.js    # æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ wrangler.toml          # Cloudflare é…ç½®
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ DEPLOYMENT.md          # éƒ¨ç½²æŒ‡å—
â””â”€â”€ frontend/                   # å‰ç«¯ React åº”ç”¨
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ pages/             # é¡µé¢ç»„ä»¶
    â”‚   â”œâ”€â”€ components/        # é€šç”¨ç»„ä»¶
    â”‚   â””â”€â”€ services/          # API æœåŠ¡
    â”œâ”€â”€ package.json
    â””â”€â”€ public/
```

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºé—®å·

1. è®¿é—®é—®å·åˆ›å»ºé¡µé¢
2. è¾“å…¥è‡ªç„¶è¯­è¨€æè¿°ï¼š
   ```
   åˆ›å»ºä¸€ä¸ªå…³äºæ–°å‘˜å·¥åŸ¹è®­æ•ˆæœçš„é—®å·ï¼ŒåŒ…æ‹¬ï¼š
   - åŸ¹è®­å†…å®¹æ»¡æ„åº¦è¯„åˆ†
   - è®²å¸ˆè¡¨ç°è¯„ä»·
   - åŸ¹è®­æ—¶é•¿æ˜¯å¦åˆé€‚
   - å¼€æ”¾æ€§å»ºè®®åé¦ˆ
   ```
3. AI è‡ªåŠ¨ç”Ÿæˆä¸“ä¸šé—®å·
4. å¯è¿›ä¸€æ­¥ç¼–è¾‘å’Œè‡ªå®šä¹‰
5. ä¿å­˜å¹¶è·å¾—åˆ†äº«é“¾æ¥

### å¡«å†™é—®å·

1. é€šè¿‡åˆ†äº«é“¾æ¥è®¿é—®é—®å·
2. å¡«å†™å„ç±»é¢˜å‹ï¼ˆå•é€‰ã€å¤šé€‰ã€è¯„åˆ†ç­‰ï¼‰
3. æäº¤ç­”æ¡ˆ

### æŸ¥çœ‹ç»“æœ

1. è®¿é—®ç»“æœé¡µé¢
2. æŸ¥çœ‹ç»Ÿè®¡å›¾è¡¨
3. ä¸‹è½½åŸå§‹æ•°æ®

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | è¯´æ˜ | å¿…éœ€ |
|--------|------|------|
| `OPENAI_API_KEY` | OpenAI GPT API å¯†é’¥ | é€‰æ‹©ä¸€ä¸ª |
| `GEMINI_API_KEY` | Google Gemini API å¯†é’¥ | é€‰æ‹©ä¸€ä¸ª |
| `CLAUDE_API_KEY` | Anthropic Claude API å¯†é’¥ | é€‰æ‹©ä¸€ä¸ª |

### æ•°æ®åº“è¡¨ç»“æ„

#### surveys è¡¨
```sql
CREATE TABLE surveys (
    id TEXT PRIMARY KEY,
    title TEXT,
    json TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    owner_id TEXT
);
```

#### results è¡¨
```sql
CREATE TABLE results (
    id TEXT PRIMARY KEY,
    survey_id TEXT NOT NULL,
    data TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (survey_id) REFERENCES surveys(id)
);
```

## ğŸ’¡ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **React** - ç”¨æˆ·ç•Œé¢æ¡†æ¶
- **SurveyJS** - é—®å·æ ¸å¿ƒåº“
  - `survey-react-ui` - é—®å·æ¸²æŸ“
  - `survey-creator` - é—®å·ç¼–è¾‘å™¨
  - `survey-analytics` - ç»“æœåˆ†æ
- **Cloudflare Pages** - é™æ€ç½‘ç«™æ‰˜ç®¡

### åç«¯
- **Cloudflare Workers** - Serverless è®¡ç®—
- **Cloudflare D1** - SQL æ•°æ®åº“
- **å¤š LLM æ”¯æŒ** - AI é—®å·ç”Ÿæˆ

### AI æ¨¡å‹
- **OpenAI GPT** - ä¸»æ¨é€‰æ‹©
- **Google Gemini** - å¤‡é€‰æ–¹æ¡ˆ
- **Anthropic Claude** - å¤‡é€‰æ–¹æ¡ˆ

## ğŸ“ˆ æˆæœ¬åˆ†æ

åŸºäº Cloudflare å…è´¹å¥—é¤ï¼š

| æœåŠ¡ | å…è´¹é¢åº¦ | è¶…å‡ºè´¹ç”¨ |
|------|----------|----------|
| Workers | 100,000 è¯·æ±‚/å¤© | $0.50/ç™¾ä¸‡è¯·æ±‚ |
| Pages | æ— é™åˆ¶ | å…è´¹ |
| D1 æ•°æ®åº“ | 25B è¡Œè¯»å– + 5M è¡Œå†™å…¥/æœˆ | æŒ‰é‡è®¡è´¹ |
| **é¢å¤–æˆæœ¬** | **LLM API è°ƒç”¨** | **æŒ‰æä¾›å•†è®¡è´¹** |

é¢„ä¼°æœˆæˆæœ¬ï¼š$0-10ï¼ˆä¸»è¦æ˜¯ LLM API è´¹ç”¨ï¼‰

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- âœ… API å¯†é’¥å®‰å…¨å­˜å‚¨åœ¨ Worker Secrets
- âœ… è¾“å…¥éªŒè¯å’Œ XSS é˜²æŠ¤
- âœ… CORS è·¨åŸŸä¿æŠ¤
- âœ… SQL æ³¨å…¥é˜²æŠ¤ï¼ˆå‚æ•°åŒ–æŸ¥è¯¢ï¼‰
- âœ… å‰åç«¯åˆ†ç¦»æ¶æ„

## ğŸš€ æ‰©å±•åŠŸèƒ½

- [ ] ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [ ] é—®å·æ¨¡æ¿å¸‚åœº
- [ ] é«˜çº§æ•°æ®åˆ†æ
- [ ] Webhook é›†æˆ
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] ç§»åŠ¨ç«¯ä¼˜åŒ–
- [ ] æ‰¹é‡å¯¼å…¥/å¯¼å‡º

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ†˜ æ”¯æŒ

- ğŸ“– æŸ¥çœ‹ [è®¾è®¡æ–‡æ¡£](DESIGN.md) äº†è§£æ¶æ„ç»†èŠ‚
- ğŸš€ æŸ¥çœ‹ [éƒ¨ç½²æŒ‡å—](backend/DEPLOYMENT.md) äº†è§£éƒ¨ç½²æ­¥éª¤
- ğŸ“‹ æŸ¥çœ‹ [è¿­ä»£è®¡åˆ’](ITERATION_PLAN.md) äº†è§£å¼€å‘è¿›åº¦
- ğŸ› [æäº¤ Issue](../../issues) æŠ¥å‘Šé—®é¢˜
- ğŸ’¬ [å‘èµ·è®¨è®º](../../discussions) äº¤æµæƒ³æ³•

## ğŸ™ è‡´è°¢

- [SurveyJS](https://surveyjs.io/) - å¼ºå¤§çš„é—®å·æ ¸å¿ƒåº“
- [Cloudflare](https://cloudflare.com/) - ä¼˜ç§€çš„è¾¹ç¼˜è®¡ç®—å¹³å°
- [OpenAI](https://openai.com/) - å…ˆè¿›çš„è¯­è¨€æ¨¡å‹æŠ€æœ¯

---

**â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ª Starï¼**